翻译学习论文[SPGrid: A Sparse Paged Grid structure applied to adaptive smoke simulation](http://pages.cs.wisc.edu/~sifakis/papers/SPGrid.pdf)  
## 摘要
我们提出了一种用于流体模拟的高分辨率自适应网格，该网格的吞吐量和平行化潜力能和均匀网格媲美。我们并没有构建基于树的自适应结构，而是数据存储于稀疏填充的均匀网格的金字塔中，从而避免间接访问的开销。
## 1 介绍
我们提出SPGrid(Sparse Paged Grid简写)，一个稀疏均匀网格的存储和流处理的新型数据结构。SPGrid复制了使用均匀网格的吞吐量潜力和编程经验，同时其存储占用空间更小。我们使用这种数据结构来构造用于流体模拟的自适应离散化，其中传统的基于树和指针的表示已由稀疏填充的均匀网格金字塔代替（参见图2）。我们证明了使用我们的思路可以实现所有在自适应CFD模拟中使用的昂贵的算法，而无需显式地遍历树，而是通过结合高效的在均匀网格上进行的高效流式核函数。最后，我们为压力Poisson方程提供了一种自适应多网格预处理Krylov求解器，该求解器具有非常轻的覆盖范围，并且在收敛性和可伸缩性方面优于基于不完全分解的替代方法。  
`Contributions` 我们总结了我们的主要核心成果如下：  
一种新颖的轻量级数据结构(SPGrid)，用于大型，稀疏的笛卡尔网格，它利用虚拟内存子系统已建立的硬件加速机制来实现与密集统一网格的竞争性能，并支持以不相同的方式协调存储多个数据通道(尽管类似)的支持领域。SPGrid使用`Morton编码`将3D数据集映射到线性内存范围。但是，我们展示了如何使用线性化(编码)地址本地执行模版操作，而不将其转换为几何坐标。  
## 3 稀疏页网格
不同应用领域会基于他们独特的需求来采取稀疏自适应存储策略(八叉树、哈希网格、RLE等等)。CFD应用，有着具体设计需求：我们观察到顺序访问和模板访问是最常用的使用情景；即使是随机访问也通常表现出空间连贯性(比如，半拉格朗日平流)。  
我们提出了一种稀疏均匀网格，可以用来解决窄带水平集问题。我们注意到，如果不考虑内存占用量，则原则上可以通过简单地分配密集的均匀网格并仅使用其稀疏相关子集来满足上述算法规范。在这种情况下，模板访问特别容易直接进行优化，因为网格位置的特定邻居始终会存储一个与参考数据点的地址相距一定偏移量的常量内存。尽管使用密集存储作为简化对稀疏子集的访问的手段显然是不切实际的(我们工作中的网格占用率可能低至0.1％)，但该概念类似于虚拟内存的操作方式。  
## 3.1 数组格式
我们提出的SPGrid结构为多维(2D/3D)数组提供了抽象，该数组仅包含其条目的稀疏子集中的数据。与C++静态数组类似，每个数组坐标(无论是否填充)在(虚拟)内存中都有一个特定的位置，用于存储其内容。这与基于指针的八叉树，VDB或散列网格相反，后者将在首次访问时对存储进行堆分配，并在几何数组坐标与给定条目的实际内存位置之间保持显式转换。尽管SPGrid为稀疏网格保留了巨大的虚拟内存地址范围，但是只有极少数的阵列条目子会被触及并占用物理内存中的空间。尽管SPGrid为稀疏网格保留了巨大的虚拟内存地址范围，但是只有极少数的阵列条目子会被触及并占用物理内存中的空间。  
与C++数组的字典顺序不同，SPGrid使用自定义遍历模式将2D/3D几何坐标映射为线性化的内存偏移量。我们首先将阵列划分为一些小巧的矩形块(我们的流体模拟示例使用4×4×4个块)。通过字典序地遍历每个块的内容，数组坐标映射到一维内存偏移地址，并且将块沿着Morton空间填充曲线来放置，如图3。Morton order是一种局部提升映射，确保在空间几何位置上接近的条目会被存储在内存上相近的位置。所以，如果数组的稀疏占用模式展示出高的空间一致性，则相应的数据将在存储器中高度集中。下一步是为整个阵列保留虚拟内存地址范围，但在需要访问其内容之前不占用物理内存空间。   